(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{35:function(e,t,a){e.exports=a(55)},51:function(e,t,a){},52:function(e,t,a){},55:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(23),i=a.n(s),l=a(5),o=a(17),c=a(25),u=a(3),h=a(4),m=a(20),p=a.n(m),f=(a(44),a(46),a(49),{src:"es",target:"en"}),b=function(e){return{type:"LOGIN_ACTION",payload:e}},g=function(e){return{type:"GOT_PREFS",prefs:e}},d={apiKey:"AIzaSyA-nW21JGoMUfz5JyI5cFQiJL8_9etUXBw",authDomain:"react-language.firebaseapp.com",databaseURL:"https://react-language.firebaseio.com",projectId:"react-language",storageBucket:"",messagingSenderId:"624932585997",appId:"1:624932585997:web:14319ed2f1ff3514"},v={prefs:f},E=function(){function e(){var t=this;Object(u.a)(this,e),this.createUser=function(e,a){return t.auth.createUserWithEmailAndPassword(e,a)},this.login=function(e,a){return e&&a?t.auth.signInWithEmailAndPassword(e,a):t.auth.signInAnonymously()},this.logOut=function(){return t.auth.signOut()},this.resetPass=function(e){return t.auth.sendPasswordResetEmail(e)},this.updatePass=function(e){return t.auth.currentUser.updatePassword(e)},this.getPrefs=function(){return t.auth.currentUser?t.db.ref("/users/"+t.auth.currentUser.uid+"/prefs").once("value"):null},this.setPrefs=function(e){if(!t.auth.currentUser)return null;var a=t.db.ref("/users/"+t.auth.currentUser.uid+"/prefs");console.log(e),a.update(e)},this.translate=function(e,a,n){var r={text:e,source:a,target:n};return t.functions.httpsCallable("translate")(r)},p.a.initializeApp(d),this.auth=p.a.auth(),this.db=p.a.database(),this.functions=p.a.functions(),window.auth=this.auth,this.userState=v,this.unsub=this.auth.onAuthStateChanged(function(e){e&&(y.dispatch(b(e.email)),t.getPrefs().then(function(e){var t=e.val();t&&y.dispatch(g(t))})),t.unsub()})}return Object(h.a)(e,[{key:"email",value:function(){return this.auth.currentUser?this.auth.currentUser.email:null}}]),e}();var y=Object(c.b)(function(e,t){switch(console.log("Responding to: "),console.log(t),t.type){case"LOGIN_ACTION":return Object(o.a)({},e,{user:t.payload});case"LOGOUT_ACTION":return Object(o.a)({},e,{user:null});case"GOT_PREFS":return console.log("got prefs:"+t.prefs),Object(o.a)({},e,{prefs:t.prefs});default:return e}},{user:null,prefs:f,firebase:new E}),O=(a(51),a(10)),w=a(9),j=a(11),k=a(7),N=(a(52),a(18)),S=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(O.a)(this,Object(w.a)(t).call(this,e))).state={cachedTranslation:null,showTranslation:!1},a}return Object(j.a)(t,e),Object(h.a)(t,[{key:"translate",value:function(e){var t=this;this.setState({showTranslation:!this.state.showTranslation});this.props.firebase.translate(this.props.data.text,this.props.prefs.src,this.props.prefs.target).then(function(e){return JSON.parse(e.data)}).then(function(e){return e.text[0]}).then(function(e){t.setState({cachedTranslation:e})}).catch(function(e){console.log("translation error"),console.log(e),t.setState({cachedTranslation:"Please log in to view translations. If you are already logged in, this is an error."})})}},{key:"render",value:function(){var e="".concat(this.props.data.tag.toLowerCase());return r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-6"},r.a.createElement(e,null,this.props.data.text)),r.a.createElement("div",{className:"col-1"},r.a.createElement("button",{onClick:this.translate.bind(this)},this.state.showTranslation?"hide":"translate")),r.a.createElement("div",{className:"col-4"},this.state.showTranslation?this.state.cachedTranslation||"fetching... ":null))}}]),t}(r.a.Component);var P=Object(l.b)(function(e,t){return{firebase:e.firebase}})(S);var C=function(e){return e.items?r.a.createElement("ul",{className:"list-group"},e.items.map(function(t,a){return r.a.createElement("li",{key:a,className:"list-group-item"},r.a.createElement(P,{prefs:e.prefs,data:t}))})):null},T=a(15),L=[{full:"English",abbr:"en"},{full:"Spanish",abbr:"es"},{full:"French",abbr:"fr"},{full:"German",abbr:"de"},{full:"Italian",abbr:"it"},{full:"Portuguese",abbr:"pt"}],I=function(e){function t(e){var a;Object(u.a)(this,t),console.log(e),a=Object(O.a)(this,Object(w.a)(t).call(this,e));var n=e.priorPrefs,r=n.src,s=n.target;return a.state={src:r,target:s,invalid:!1},a}return Object(j.a)(t,e),Object(h.a)(t,[{key:"save",value:function(){this.props.save({src:this.state.src,target:this.state.target})}},{key:"change",value:function(e){var t,a=e.target.value,n=e.target.name,r="src"===n?"target":"src";this.setState((t={},Object(T.a)(t,n,a),Object(T.a)(t,"invalid",a===this.state[r]),t))}},{key:"cancel",value:function(){this.props.save(null)}},{key:"render",value:function(){return r.a.createElement("div",{className:"form-group col-6"},r.a.createElement("label",null," Goal Language (articles will appear in this language):"),r.a.createElement("select",{value:this.state.src,onChange:this.change.bind(this),className:"form-control",name:"src"},L.map(function(e,t){return r.a.createElement("option",{key:t,value:e.abbr},e.full)})),r.a.createElement("label",null," Home Language (articles will be translated into this language):"),r.a.createElement("select",{value:this.state.target,onChange:this.change.bind(this),className:"form-control",name:"target"},L.map(function(e,t){return r.a.createElement("option",{key:t,value:e.abbr},e.full)})),r.a.createElement("button",{disabled:this.state.invalid,onClick:this.save.bind(this)},"save"),r.a.createElement("button",{onClick:this.cancel.bind(this)},"cancel"),this.state.invalid?r.a.createElement("p",null,"Please select a different source and target language!"):null)}}]),t}(r.a.Component),U=function(){return r.a.createElement("div",{className:"container-fluid landing"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-lg-6"},r.a.createElement("h3",null,"LingBash is a language learning tool!"),r.a.createElement("p",null,"Designed to help users with vocabulary and reading comprehension, LingBash allows users to read wikipedia articles in your goal language without viewing translations. The articles are displayed section-by-section. If you reach a section you don't fully understand, you can view a translation into your native language. Try to read as much as you can without translating!"),r.a.createElement("p",null,"This demo page provides a preview of it's core functionality. To view translations, you must first ",r.a.createElement(k.b,{to:"/login"}," Log In ")," or continue as a guest (available on Login page). Then, continue to the ",r.a.createElement(k.b,{to:"/search"}," Search ")," page. Use the 'show preferences' menu select your goal language (the language you are learning) and your home language."),r.a.createElement("p",null,"Finally, simply search for articles in your goal language!"))))};function x(e){try{var t=e.query.pages;return t[Object.keys(t)[0]].extract}catch(a){return null}}function A(e){if(e){var t=document.createElement("div");return t.innerHTML=e,Array.from(t.children).filter(function(e){return"P"===e.nodeName||"H"===e.nodeName[0].toUpperCase()}).filter(function(e){return e.innerText.length>2}).map(function(e){return{tag:e.nodeName,text:e.innerText}})}}var D=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(O.a)(this,Object(w.a)(t).call(this,e))).state={value:"",term:"",results:[]},a}return Object(j.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){console.log("mounted")}},{key:"handleChange",value:function(e){this.setState({value:e.target.value})}},{key:"handleSubmit",value:function(e){var t,a,n=this;e.preventDefault(),(t=this.state.value,a=this.props.prefs.src,fetch("https://"+a+".wikipedia.org/w/api.php?action=query&prop=extracts&format=json&origin=*&titles="+t)).then(function(e){return e.json()}).then(x).then(A).then(function(e){return n.setState({results:e})})}},{key:"clear",value:function(e){e.preventDefault(),this.setState({results:[]})}},{key:"hidePrefs",value:function(e){e.preventDefault(),this.setState({showPrefs:!1})}},{key:"showPrefs",value:function(e){e.preventDefault(),this.setState({showPrefs:!0})}},{key:"changePrefs",value:function(e){e?(this.setState({results:[]}),this.setState({showPrefs:!1}),y.dispatch(g(e)),this.props.firebase.setPrefs(e)):this.setState({showPrefs:!1})}},{key:"render",value:function(){return r.a.createElement("div",{id:"wrap"},r.a.createElement("nav",{className:"navbar navbar-expand-lg navbar-light bg-light"},r.a.createElement("form",{onSubmit:this.handleSubmit.bind(this)},r.a.createElement("label",null,"Search:",r.a.createElement("input",{type:"text",value:this.state.value,onChange:this.handleChange.bind(this)})),r.a.createElement("input",{type:"submit",value:"Submit"}),r.a.createElement("button",{onClick:this.clear.bind(this)},"clear"),this.state.showPrefs?r.a.createElement("button",{onClick:this.hidePrefs.bind(this)},"Hide Preferences"):r.a.createElement("button",{onClick:this.showPrefs.bind(this)},"Show Preferences"),this.props.user?r.a.createElement("span",null," Hello, ",this.props.user.email||"anonymous","! "):r.a.createElement("span",null,"Logged out"))),this.state.showPrefs?r.a.createElement(I,{save:this.changePrefs.bind(this),priorPrefs:this.props.prefs}):null,r.a.createElement(C,{prefs:this.props.prefs,items:this.state.results}),this.props.user?null:r.a.createElement(U,null))}}]),t}(r.a.Component);var G=Object(l.b)(function(e,t){return Object(o.a)({},t,{firebase:e.firebase,user:e.user,prefs:e.prefs})})(D),_=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(O.a)(this,Object(w.a)(t).call(this,e))).state={email:"",pass:"",error:null},a}return Object(j.a)(t,e),Object(h.a)(t,[{key:"submit",value:function(e){var t=this;e.preventDefault(),this.props.firebase.login(this.state.email,this.state.pass).then(function(e){t.setState({email:"",pass:""}),t.props.history.push("/home"),t.props.setLogin(e.user),t.props.firebase.getPrefs().then(function(e){y.dispatch(g(e.val()))})}).catch(function(e){t.setState({error:e})})}},{key:"change",value:function(e){this.setState(Object(T.a)({},e.target.name,e.target.value))}},{key:"guestLogin",value:function(){var e=this;this.props.firebase.login(null,null).then(function(t){e.setState({email:"",pass:""}),e.props.history.push("/home"),console.log(t),console.log(t.user),e.props.setLogin(t.user)})}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("form",{className:"form-group col-6",onSubmit:this.submit.bind(this)},r.a.createElement("label",null," Email: "),r.a.createElement("input",{name:"email",className:"form-control",value:this.state.email,onChange:this.change.bind(this)}),r.a.createElement("label",null," Password: "),r.a.createElement("input",{type:"password",name:"pass",className:"form-control",value:this.state.pass,onChange:this.change.bind(this)}),r.a.createElement("p",null),r.a.createElement("button",{className:"form-control"},"submit"),this.state.error?r.a.createElement("p",null,this.state.error.message):null,r.a.createElement("p",null,"Don't have an account? ",r.a.createElement(k.b,{to:"/signup"}," Sign Up! ")),r.a.createElement("button",{type:"button",className:"form-control",onClick:this.guestLogin.bind(this)},"Continue as Guest")))}}]),t}(r.a.Component),B=Object(l.b)(function(e){return Object(o.a)({},e)},function(e){return{setLogin:function(t){return e(b(t))}}})(_),H=Object(N.e)(B),J=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(O.a)(this,Object(w.a)(t).call(this,e))).state={email:"",pass:""},a}return Object(j.a)(t,e),Object(h.a)(t,[{key:"submit",value:function(e){var t=this;e.preventDefault(),console.log("submit"),console.log(this.props.firebase),this.props.firebase.createUser(this.state.email,this.state.pass).then(function(e){t.props.firebase.setPrefs(t.props.prefs),t.props.history.push("/home")}).catch(function(e){t.setState({error:e})})}},{key:"change",value:function(e){this.setState(Object(T.a)({},e.target.name,e.target.value))}},{key:"render",value:function(){return r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"row"},r.a.createElement("h3",{className:"col-sm-6 text-center"},"Register New Account")),r.a.createElement("form",{className:"form-group col-6",onSubmit:this.submit.bind(this)},r.a.createElement("label",null," Email: "),r.a.createElement("input",{name:"email",className:"form-control",value:this.state.email,onChange:this.change.bind(this)}),r.a.createElement("label",null," Password: "),r.a.createElement("input",{type:"password",name:"pass",className:"form-control",value:this.state.pass,onChange:this.change.bind(this)}),r.a.createElement("p",null),r.a.createElement("button",{className:"form-control"},"submit")),this.state.error?r.a.createElement("div",null,r.a.createElement("h5",null,"error!"),this.state.error.message):null)}}]),t}(r.a.Component),R=Object(N.e)(J),W=Object(l.b)(function(e){return{firebase:e.firebase,prefs:e.prefs}})(R),F=Object(l.b)(function(e){return console.log("Drawing profile with state:"),console.log(e),{}})(function(e){return r.a.createElement("div",null,r.a.createElement("p",null,"This is the profile page. Welcome."))});var z=Object(l.b)(function(e,t){return{user:e.user,firebase:e.firebase}},function(e){return{doLogout:function(){return e({type:"LOGOUT_ACTION"})}}})(function(e){return r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement("nav",{className:"navbar navbar-expand-lg navbar-dark bg-dark"},r.a.createElement(k.b,{to:"/"},r.a.createElement("button",{className:"btn btn-primary"},"Home")),r.a.createElement(k.b,{to:"/search"},r.a.createElement("button",{className:"btn btn-primary"},"Search")),e.user?r.a.createElement("button",{className:"btn btn-primary",onClick:function(){e.firebase.logOut(),e.doLogout()}},"Log Out"):null,e.user?null:r.a.createElement(k.b,{to:"/login"},r.a.createElement("button",{className:"btn btn-primary"},"Log In")),e.user?null:r.a.createElement(k.b,{to:"/signup"},r.a.createElement("button",{className:"btn btn-primary"},"Sign Up")),"}")),r.a.createElement(N.a,{exact:!0,path:"/",component:U}),r.a.createElement(N.a,{path:"/search",component:G}),r.a.createElement(N.a,{path:"/login",component:H}),r.a.createElement(N.a,{path:"/profile",component:F}),r.a.createElement(N.a,{path:"/signup",component:W}))}),M=function(e){function t(){return Object(u.a)(this,t),Object(O.a)(this,Object(w.a)(t).apply(this,arguments))}return Object(j.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){return r.a.createElement(k.a,null,r.a.createElement(z,null))}}]),t}(r.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(54);i.a.render(r.a.createElement(l.a,{store:y},r.a.createElement(M,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[35,1,2]]]);
//# sourceMappingURL=main.5644fc28.chunk.js.map